function saveTopic(a){$form=$(a);var b=$form.find(".tnb-sceditor").sceditor("instance");return text=b.getWysiwygEditorValue(),""==text?(b.focus(),!1):(tnb_display_loading_wrap(),void $form.get(0).submit())}!function(a){a(document).ready(function(){init.push(function(){a(".thumb-up").click(function(){if(a(this).hasClass("voted"))return!1;var b=a(this);return b.button("loading"),a.ajax({"url":tnb_base_path+"forum/topic.php","data":{"objectID":b.data("id"),"objectIDHash":b.data("hashed"),"objectType":b.data("type"),"action":b.data("action")},"type":"post","dataType":"xml","success":function(c){b.button("reset"),"success"==a(c).find("status").text()?setTimeout(function(){b.html(a(c).find("votes").text()),b.removeClass("btn-outline").addClass("voted btn-primary votedStatus"+("thumb-up"==b.attr("class")?"1":"-1")),b.tooltip()},2):tnb_display_result_modal("error","Voting Error",a(c).find("message").text())},"complete":function(){}}),b.blur(),!1}),a(document).on("click",".remove-category-link",function(){return a(this).closest(".form-group").fadeOut("fast",function(){a(this).remove()}),!1}),a(document).on("click","#add-new-forum-link",function(){var b=a("#new-link-row").html();a(this).closest(".form-group").before(b),a(this).closest(".form-group").prev().find(".privacy-switcher > input").switcher()}),a("#forum-image-uploader").length>0&&($forumImageUploader=a("#forum-image-uploader").dropzone({"url":tnb_base_path+"photo_uploader.php","paramName":"file","maxFilesize":4,"maxFiles":1,"addRemoveLinks":!0,"dictResponseError":"Can't upload file!","autoProcessQueue":!1,"parallelUploads":3,"thumbnailWidth":500,"thumbnailHeight":500,"previewTemplate":'<div class="dz-preview dz-file-preview"><div class="dz-details"><div class="dz-filename"><span data-dz-name></span></div><div class="dz-size">File size: <span data-dz-size></span></div><div class="dz-thumbnail-wrapper"><div class="dz-thumbnail"><img data-dz-thumbnail><span class="dz-nopreview">No preview</span><div class="dz-success-mark"><i class="fa fa-check-circle-o"></i></div><div class="dz-error-mark"><i class="fa fa-times-circle-o"></i></div><div class="dz-error-message"><span data-dz-errormessage></span></div></div></div></div><div class="progress progress-striped active"><div class="progress-bar progress-bar-success" data-dz-uploadprogress></div></div></div>',"resize":function(a){var b={"srcX":0,"srcY":0,"srcWidth":a.width,"srcHeight":a.height},c=a.width/a.height;return a.height>this.options.thumbnailHeight||a.width>this.options.thumbnailWidth?(b.trgHeight=this.options.thumbnailHeight,b.trgWidth=b.trgHeight*c,b.trgWidth>this.options.thumbnailWidth&&(b.trgWidth=this.options.thumbnailWidth,b.trgHeight=b.trgWidth/c)):(b.trgHeight=a.height,b.trgWidth=a.width),b},"init":function(){this.on("addedfile",function(b){a("#forum-image-uploader").removeClass("has-error")}),this.on("maxfilesexceeded",function(a){this.removeAllFiles(),this.addFile(a)}),this.on("queuecomplete",function(){this.is_uploaded=!0,a(this.previewsContainer).parent().submit()}),this.on("success",function(b,c){var d=a.parseJSON(c);a(this.previewsContainer).parent().append('<input type="hidden" name="categoryFile" value="'+d.file+'" />')})}})),a(document).on("submit","#editforumform",function(){var b=!0,c=this,d=a(this);if(a(c).find(".has-error").removeClass("has-error"),a(c).find('input[type="text"], select, textarea').each(function(){""==a.trim(a(this).val())&&(b=!1,a(this).parent().addClass("has-error")),a(this).hasClass("url")&&!myRegExp.test(a(this).val())&&(b=!1,a(this).parent().addClass("has-error"))}),$forumImageUploader[0].dropzone.is_uploaded||0!=$forumImageUploader[0].dropzone.files.length||(a("#forum-image-uploader").addClass("has-error"),b=!1),!b)return!1;if(!$forumImageUploader[0].dropzone.is_cropped){a("#forum-image-uploader").hide(),a("#forum-image-cropper").show(),a("#forum-image-cropper").html(a("#forum-image-uploader .dz-thumbnail:eq(0)").find("img").clone());Math.round(Math.min(a("#forum-image-cropper img").width(),a("#forum-image-cropper img").height())/2);return a("#forum-image-cropper img").on("crop.cropper",function(b){d.find("#x").val(Math.round(b.x)),d.find("#y").val(Math.round(b.y)),d.find("#destW").val(Math.round(b.width)),d.find("#destH").val(Math.round(b.height));var c=a(this).cropper("getImageData");d.find("#srcW").val(c.naturalWidth),d.find("#srcH").val(c.naturalHeight)}).cropper({"aspectRatio":1,"movable":!1,"rotatable":!1,"zoomable":!1,"scalable":!1}),a("#forum-image-cropper").innerWidth()>a("#forum-image-cropper .jcrop-active").width()&&a("#forum-image-cropper").width(a("#forum-image-cropper .jcrop-active").width()),$forumImageUploader[0].dropzone.is_cropped=!0,!1}return a("#forum-image-uploader").show(),a("#forum-image-cropper").hide(),$forumImageUploader[0].dropzone.is_uploaded?!0:($forumImageUploader[0].dropzone.on("processing",function(){this.options.autoProcessQueue=!0}),$forumImageUploader[0].dropzone.on("queuecomplete",function(){$forumImageUploader[0].dropzone.is_uploaded=!0,a(c).submit()}),$forumImageUploader[0].dropzone.processQueue(),d.find(".btn-primary").button("loading"),!1)}),a(document).on("submit","#deleteForumForm",function(){return""==a(this).find('input[name="pwd"]').val()?(a(this).find('input[name="pwd"]').focus(),!1):(bootbox.confirm({"message":"Are you sure that you want to delete the forum?","callback":function(b){b&&setTimeout(function(){tnb_display_loading_wrap(),a("#deleteForumForm").get(0).submit()},500)},"className":"bootbox-sm"}),!1)}),a("textarea.tnb-sceditor").sceditor({"plugins":"bbcode","emoticonsRoot":"/images/","enablePasteFiltering":!0,"style":"/css/sceditor/jquery.sceditor.default.css"}),a("textarea.tnb-sceditor").length>0&&a("textarea.tnb-sceditor").sceditor("instance").keyDown(function(b){if(9==b.keyCode){var c=a("textarea.tnb-sceditor").sceditor("instance").insert("    ");return a("textarea.tnb-sceditor").sceditor("instance").inSourceMode()?c.insert("    "):c.wysiwygEditorInsertHtml1("    "),b.preventDefault(),!1}}),a(document).on("submit","#postreplyform",function(){$form=a(this);var b=$form.find(".tnb-sceditor").sceditor("instance");return text=b.getWysiwygEditorValue(),""==text?(b.focus(),!1):(tnb_display_loading_wrap(),void $form.get(0).submit())}),a("#pendingobjectsform .action-button").click(function(){var b=a("#pendingobjectsform");return b.find('input[name="action"]').val(a(this).data("action")),0==b.find(".r_id:checked").size()?(tnb_display_result_modal("error","Error","No data selected!"),!1):(tnb_display_loading_wrap(),void b.submit())})})}),"undefined"!=typeof hljs&&(hljs.configure({"useBR":!0}),a(".tnb-bbcode-content").each(function(){a(this).find("code").each(function(a,b){hljs.initHighlightingOnLoad(b)})}))}(jQuery);